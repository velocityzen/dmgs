#!/bin/bash

if [ -z "$1" ]; then
    echo "Usage: ./release <version>"
    echo "Example: ./release 1.0.0"
    exit 1
fi

VERSION=$1

echo "ğŸ”„ Updating version to $VERSION..."

# Update version in dmgs.swift
sed -i '' "s/version: \"[^\"]*\"/version: \"$VERSION\"/" Sources/dmgs/dmgs.swift

# Commit the change
git add Sources/dmgs/dmgs.swift
git commit -m "Bump version to $VERSION"

# Create git tag
git tag "$VERSION"

echo "ğŸ“¤ Pushing to GitHub..."

# Push commits and tags
git push && git push --tags

echo ""
echo "âœ… Version $VERSION released!"
echo "ğŸ·ï¸  Tag: $VERSION"
echo "ğŸ”— GitHub: https://github.com/velocityzen/dmgs/releases/tag/$VERSION"
